\chapter{Electro-osmotic flow in a slit pore}
Electro-osmotic flow (EOF) is the motion of water (or another liquid)
induced by an electric field. It can occur e.g. in porous media,
in synthetic capillaries and in vicinity of charged surfaces.
Charged objects in an electrolyte solution attract ions of one
species and repel ions of the other species, which gives rise
to a net charge density in its neighbourhood. If an external
electric field is applied, these ions are accelerated in the direction
of the electric field (or oppositely if negatively charged) which
causes also an acceleration of the surrounding water. In regions
with zero net charge, the force on the fluid exerted by both ion
species cancels, thus charged interfaces are necessary.

Conceptually electro-osmotic flow is closely related to electrophoresis,
where a charged object (e.g. a polyelectrolyte) is moved by an
electric field and the surrounding counterions create a flow field
in the opposite direction. 

In this exercise the electrokinetic equations, that allow for a classical
description of the phenomenon, are introduced and you will learn
how to simulate this effect with \ES{} with the LBM. The special case of
planar charged walls in the regime of low salt concentration can
be solved analytically and you will see that we can reproduce the
classical results quite well, but you will also learn about the
deficiencies of both approaches. We will concentrate on the case
where only one species of ions (counterions) is present. The generalization
to multiple species however is straightforward.

\section{The electrokinetic equations}
We want to describe a system in which ions can diffuse under an
applied field embedded in a fluid. We therefore assume that a 
linear convection diffusion is valid:
\begin{equation}
  \vec{j}=-D \nabla c + \mu ze c \vec{E} + c \vec{u}
\end{equation}
Here $j$ corresponds to the ion flux density, $D$ corresponds 
to the diffusion coefficient of the ions,
$c$ to their concentration, $\mu$ to their (electrophoretic)
mobility, $\vec{E}$ to the local electric field and $\vec{u}$
to the fluid velocity.

The fluid fulfills the incompressible Navier-Stokes equation:
Here the term $c \vec{E}$ appears as source term due
to the acceleration of the fluid caused by the ions. 

For the electrostatic potential we make the following
mean field approximation: The electric potential is 
caused not by single ions, but their density. This means
every ion is not exposed to the instantaneous potential
but the smeared out potential of all other ions. Then the Poisson
equation reads as:
\begin{equation}
  \Delta \Phi = -c/\varepsilon
  \label{asdf}
\end{equation}
We will later
see that this approximation can be overcome if we move
from a continuum description to a molecular dynamics simulation
of explicit ions.

This set of coupled partial differential equations is called
the electrokinetic equations. 

\section{The slit pore geometry}
We want to investigate the simplest case where EOF occurs:
The flow water through the volume between two parallel
charged planes in the $xy$-plane. We assume that the planes are infinitely
extended in the directions parallel to the plane and that
the number of ions exactly cancels the charge of both planes
and that the external electric field is exerted in $x$ direction
and that the position of the plates is at $z=\pm l/2$.
The translational invariance allows to greatly simplify the
electrokinetic equations:
\begin{eqnarray}
  u_z = u_y = 0 \\
  j_z = 0 \rightarrow +D \nabla c + \mu ze c \partial_z \Phi = 0
  \partial_z \Phi = -c/\varepsilon \\
  \partial_z^2 u_x = zeEc
  \label{EOF}
\end{eqnarray}
This set of ordinary differential equations is almost decoupled, 
and the ion concentration profile $c\left(z\right)$ is independent
of the fluid velocity. With the Einstein relation $D=\mu kT$ it the
Poisson equation can be written in the following well known form:
\begin{equation}
  \partial_z^2 \Phi = c_0 \exp{\frac{-ze\Phi}{kT}}
\end{equation}
which is the one-dimensional Poisson-Boltzmann equation. One can say:
The density of the ions is proportional to their associated
Boltzmann factor. The factor $c_0$ appears as integration constant
and can be chosen to assure charge neutrality.

For planes with charge density $\sigma$ this can be solved by:
Here the parameter $asdf$ has to fulfill the following transcendental
equation:
Integrating the charge density twice yield the fluid flow field
in the direction parallel to the applied field:
Here the integration constants were chosen so that no-slip boundary
conditions are fulfilled a $z = \pm l/2$.

Before simulating the full system, we make two steps in between, because
we need to know how to have walls in an \ES{} simulation. First we want
to simulate Poisseuille flow, the famous parabolic flow profile, in a slit
geometry and then we want to simulation particles between two walls. Finally
we combine it all to simulate the full system.
\section{Poiseuille flow \ES{}}
Poisseuille flow is the flow through a pipe or (in our case) a slit
under a homogenous force density, e.g. gravity. In the limit of small Reynolds
numbers, the flow can be described with the Stokes equation. 
We assume the slit being extended in $y$ and $z$ direction and a force
density in $y$ direction. No slip-boundary conditions  (i.e. $\vec{u}=0$)
are located at $z = \pm l/2$.
Assuming invariance in $y$ and $z$ direction and a steady state 
the stokes equation simplifies to:
\begin{equation}
  \eta \partial_x^2 u_y = f
\end{equation}
where $f$ denotes the force density and $\eta$ the dynamic viscosity.
This can be integrated twice and the integration constants are chosen
so that $u_y=0$ at $z = \pm l/2$ and we obtain:
\begin{equation}
  u_y = u_0 - WTF???
\end{equation}
With that knowledge investigate the script poisseuille.tcl.
Note the \lstinline{lb_boundary} command. Two walls are created
with normal vectors $\left(\pm 1, 0, 0 \right)$. An external force
is applied to every node. After 1000 LB updates the steady state should
be reached.

Task: Write a loop that prints the fluid velocity at the nodes (0,0,0) to (16,0,0)
and the node position to a file. Use the \lstinline|lbnode| command for that. Hint: to write 
to a file, first open a file and then use the \lstinline|puts| command to write 
into it. Do not forget to close the file afterwards. Example:
\vspace{ 0,2cm}
\begin{lstlisting}[numbers=none]
set ofile [ open "file.txt" "w" ]
puts $ofile "hello world!"
close $ofile
\end{lstlisting}
\vspace{ 0,2cm}

Use gnuplot to fit a parabolic profile. Can you confirm the analytic solution?

\section{Constraints in \ES{}}
The \lstinline|constraint| command of \ES{} creates walls in the system.
They have a particular ``particle'' type and interact with the particles
present in the system with the defined potential. This means the distance
of every particle to the constraint is calculated and used as the distance 
in the interaction potential.

To set up a planar channel just as before one would use the commands:
\begin{lstlisting}[numbers=none]
constraint wall 0.5 normal 1. 0. 0. type 1
constraint wall -8.5 normal -1. 0. 0. type 1
inter 0 1 lennard-jones 1. 1. 1.225 0.25 0
\end{lstlisting}
This wall is felt only by particles of type 0 and has an effective width
of 6, as the potential goes steeply up at positions 1.5 and 7.5.

The syntax of the wall constraint looks weird at first, because a negative
distance from the origin (first argument) is given, but the idea is that
this distance times the normal vector is a point of the plane. For inclined
walls this syntax is more easy to understand.)

\ES{} complains every time a particle penetrates the wall, as it does not
expect the particles to do so. This should normally cause no problem. 

To set up a system we have, of course to make sure, that our initial
configuration obeys the constraints. The easiest thing is to 
generate particle configurations randomly and repeat this process
for every particle until a configuration is found, that
is within the allowed range. Look at the script \lstinline|boundaries.tcl|
and see how that is solved. What does the script do?

\section{Simulating EOF in \ES{}}
The last thing that is missing for the simulation of EOF is
how to create a charged wall. This can be done with
particles, using the \lstinline|fix| command. The command
\begin{lstlisting}[numbers=none]
part 0 pos 1. 1. 1. q 1. fix 1 1 1
\end{lstlisting}
create a particle at the position $\left(1,1,1\right)$ with
charge 1 that is fixed in all the spacial dimensions.

In \lstinline|eof.tcl| two walls are created. Now use what was
used before to run the final system. Use the particle
creation method from \lstinline|boundaries.tcl| to
create particles and walls in the system. Place the particle
walls at 2.5 and 14.5. Charge the particles so that
the overall system is neutral, but remove the external force. 
Use a Langevin thermostat
to equilibrate the system. What happens during the equilibration?
The equilibration should be done in 10000 MD steps.

Use the density profile method from \lstinline|boundaries.tcl| 
to measure the density. Use a production run of 10000 MD steps
and update the density profile every 100 MD steps.

Investigate it with gnuplot. How does it compare to the 
PB prediction?

After this add the LB fluid from \lstinline|poisseuille.tcl|.
Add it before the production cycles, but after the equilbration.
Now add the external force again to the particles. An run the 
simulation again. Does the ion density profile change? Would
you expect it to change? Finally implement a method that averages
the fluid density profile. Use gnuplot to investigate
the flow profile. Is it compatible with the theory?














